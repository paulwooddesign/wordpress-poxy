/**
 * All Tax meta class
 *
 * JS used for the custom fields and other form items.
 *
 * Copyright 2012 Ohad Raz (admin@bainternet.info)
 * @since 1.0
 * 
 * @package Tax Meta Class
 * 
 */function update_repeater_fields(){$(".theEditor").each(function(){typeof tinyMCE=="object"&&typeof tinyMCE.execCommand=="function"&&tinyMCE.execCommand("mceAddControl",!1,$(this).attr("id"))});$(".at-date").each(function(){var e=$(this),t=e.attr("rel");e.datepicker({showButtonPanel:!0,dateFormat:t})});$(".at-time").each(function(){var e=$(this),t=e.attr("rel");e.timepicker({showSecond:!0,timeFormat:t})});$(".at-color-select").click(function(){var e=$(this),t=e.attr("rel");$(this).siblings(".at-color-picker").farbtastic("#"+t).toggle();return!1});$(".at-upload").delegate(".at-delete-file","click",function(){var e=$(this),t=e.parent(),n=e.attr("rel");$.post(ajaxurl,{action:"at_delete_file",data:n},function(e){e=="0"?(alert("File has been successfully deleted."),t.remove()):alert("You do NOT have permission to delete this file.")});return!1});$(".at-images").each(function(){var e=$(this),t,n;e.sortable({placeholder:"ui-state-highlight",update:function(){t=e.sortable("serialize");n=t+"|"+e.siblings(".at-images-data").val();$.post(ajaxurl,{action:"at_reorder_images",data:n},function(e){e=="0"?alert("Order saved!"):alert("You don't have permission to reorder images.")})}})})}var $=jQuery.noConflict();jQuery(document).ready(function(e){function t(e){var t=RegExp("[?&]"+e+"=([^&#]*)").exec(location.href);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function n(){jQuery(".mupload_img_holder").each(function(e,t){if(jQuery(this).next().next().val()!=""&&!jQuery(this).children().size()>0){jQuery(this).append('<img src="'+jQuery(this).next().next().val()+'" style="height: 150px;width: 150px;" />');jQuery(this).next().next().next().val("Delete");jQuery(this).next().next().next().removeClass("at-upload_image_button").addClass("at-delete_image_button")}})}e(".at-re-toggle").live("click",function(){e(this).prev().toggle("slow")});e(".at-date").each(function(){var t=e(this),n=t.attr("rel");t.datepicker({showButtonPanel:!0,dateFormat:n})});e(".at-time").each(function(){var t=e(this),n=t.attr("rel");t.timepicker({showSecond:!0,timeFormat:n})});e(".at-color").live("focus",function(){var t=e(this);e(this).siblings(".at-color-picker").farbtastic(t).toggle()});e(".at-color").live("focusout",function(){var t=e(this);e(this).siblings(".at-color-picker").farbtastic(t).toggle()});e(".at-add-file").click(function(){var t=e(this).parent().find(".file-input:first");t.clone().insertAfter(t).show();return!1});e(".at-upload").delegate(".at-delete-file","click",function(){var n=e(this),r=n.parent(),i=n.attr("rel"),s=e(this).index();e.post(ajaxurl,{action:"at_delete_file",data:i,tag_id:t("tag_ID")},function(e){e=="0"?(alert("File has been successfully deleted."),r.remove()):alert("You do NOT have permission to delete this file.")});return!1});n();jQuery(".at-delete_image_button").live("click",function(r){var i=jQuery(this).attr("rel"),s=jQuery(this).prev().prev(),o=jQuery(this).prev(),u=jQuery(this);data={action:"at_delete_mupload",_wpnonce:e("#nonce-delete-mupload_"+i).val(),post_id:t("tag_ID"),field_id:i,attachment_id:jQuery(s).val()};e.getJSON(ajaxurl,data,function(e){if("success"==e.status){jQuery(u).val("Upload Image");jQuery(u).removeClass("at-delete_image_button").addClass("at-upload_image_button");jQuery(s).val("");jQuery(o).val("");jQuery(s).prev().html("");n()}else alert(e.message)});return!1});var r,i;jQuery(".at-upload_image_button").live("click",function(t){r=jQuery(this).prev();i=jQuery(this).prev().prev();tb_show("","media-upload.php?post_id=0&type=image&amp;TB_iframe=true&tax_meta_c=instopo");tbframe_interval=setInterval(function(){e("#TB_iframeContent").contents().find(".url").hide();e("#TB_iframeContent").contents().find(".align").hide();e("#TB_iframeContent").contents().find(".image_alt").hide();e("#TB_iframeContent").contents().find(".post_excerpt").hide();e("#TB_iframeContent").contents().find(".post_content").hide();e("#TB_iframeContent").contents().find(".image-size").hide();e("#TB_iframeContent").contents().find('[value="Insert into Post"]').val("Use this image")},2e3);window.restore_send_to_editor=window.send_to_editor;window.send_to_editor=function(e){d=jQuery("<div>").html(e);imgurl=d.find("img").attr("src");img_calsses=d.find("img").attr("class").split(" ");att_id="";jQuery.each(img_calsses,function(e,t){if(t.indexOf("wp-image")!=-1){att_id=t.replace("wp-image-","");return!0}});jQuery(i).val(att_id);jQuery(r).val(imgurl);n();tb_remove();window.send_to_editor=window.restore_send_to_editor};return!1})});